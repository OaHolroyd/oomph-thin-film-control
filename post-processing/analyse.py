import numpy as np
import matplotlib.pyplot as plt

dt = 0.1
t = []
hmax = [];

hmax_basilisk = np.array([[-9999.000000, 0.015810],
[-9998.375000, 0.015739],
[-9997.750000, 0.015566],
[-9997.125000, 0.015363],
[-9996.500000, 0.015210],
[-9995.875000, 0.015183],
[-9995.250000, 0.015345],
[-9994.625000, 0.015735],
[-9994.000000, 0.016363],
[-9993.375000, 0.017217],
[-9992.750000, 0.018267],
[-9992.125000, 0.019476],
[-9991.500000, 0.020791],
[-9990.875000, 0.022185],
[-9990.250000, 0.023647],
[-9989.625000, 0.025169],
[-9989.000000, 0.026752],
[-9988.375000, 0.028399],
[-9987.750000, 0.030117],
[-9987.125000, 0.031916],
[-9986.500000, 0.033806],
[-9985.875000, 0.035798],
[-9985.250000, 0.037902],
[-9984.625000, 0.040130],
[-9984.000000, 0.042491],
[-9983.375000, 0.044995],
[-9982.750000, 0.047651],
[-9982.125000, 0.050489],
[-9981.500000, 0.053517],
[-9980.875000, 0.056737],
[-9980.250000, 0.060142],
[-9979.625000, 0.063723],
[-9979.000000, 0.067471],
[-9978.375000, 0.071371],
[-9977.750000, 0.075399],
[-9977.125000, 0.079541],
[-9976.500000, 0.083791],
[-9975.875000, 0.088143],
[-9975.250000, 0.092595],
[-9974.625000, 0.097144],
[-9974.000000, 0.101786],
[-9973.375000, 0.106522],
[-9972.750000, 0.111350],
[-9972.125000, 0.116270],
[-9971.500000, 0.121280],
[-9970.875000, 0.126380],
[-9970.250000, 0.131570],
[-9969.625000, 0.136851],
[-9969.000000, 0.142221],
[-9968.375000, 0.147680],
[-9967.750000, 0.153229],
[-9967.125000, 0.158866],
[-9966.500000, 0.164590],
[-9965.875000, 0.170402],
[-9965.250000, 0.176297],
[-9964.625000, 0.182276],
[-9964.000000, 0.188335],
[-9963.375000, 0.194473],
[-9962.750000, 0.200685],
[-9962.125000, 0.206972],
[-9961.500000, 0.213337],
[-9960.875000, 0.219794],
[-9960.250000, 0.226364],
[-9959.625000, 0.233075],
[-9959.000000, 0.239958],
[-9958.375000, 0.247049],
[-9957.750000, 0.254383],
[-9957.125000, 0.261999],
[-9956.500000, 0.269930],
[-9955.875000, 0.278211],
[-9955.250000, 0.286871],
[-9954.625000, 0.295938],
[-9954.000000, 0.305437],
[-9953.375000, 0.315392],
[-9952.750000, 0.325816],
[-9952.125000, 0.336717],
[-9951.500000, 0.348088],
[-9950.875000, 0.359916],
[-9950.250000, 0.372179],
[-9949.625000, 0.384848],
[-9949.000000, 0.397885],
[-9948.375000, 0.411248],
[-9947.750000, 0.424881],
[-9947.125000, 0.438731],
[-9946.500000, 0.452737],
[-9945.875000, 0.466875],
[-9945.250000, 0.481149],
[-9944.625000, 0.495601],
[-9944.000000, 0.510282],
[-9943.375000, 0.525251],
[-9942.750000, 0.540551],
[-9942.125000, 0.556218],
[-9941.500000, 0.572265],
[-9940.875000, 0.588693],
[-9940.250000, 0.605466],
[-9939.625000, 0.622523],
[-9939.000000, 0.639769],
[-9938.375000, 0.657118],
[-9937.750000, 0.674513],
[-9937.125000, 0.691947],
[-9936.500000, 0.709425],
[-9935.875000, 0.726958],
[-9935.250000, 0.744530],
[-9934.625000, 0.762103],
[-9934.000000, 0.779594],
[-9933.375000, 0.796901],
[-9932.750000, 0.813884],
[-9932.125000, 0.830432],
[-9931.500000, 0.846478],
[-9930.875000, 0.862004],
[-9930.250000, 0.876991],
[-9929.625000, 0.891422],
[-9929.000000, 0.905248],
[-9928.375000, 0.918408],
[-9927.750000, 0.930809],
[-9927.125000, 0.942358],
[-9926.500000, 0.952958],
[-9925.875000, 0.962563],
[-9925.250000, 0.971163],
[-9924.625000, 0.978783],
[-9924.000000, 0.985437],
[-9923.375000, 0.991157],
[-9922.750000, 0.995957],
[-9922.125000, 0.999870],
[-9921.500000, 1.002911],
[-9920.875000, 1.005116],
[-9920.250000, 1.006509],
[-9919.625000, 1.007137],
[-9919.000000, 1.007037],
[-9918.375000, 1.006270],
[-9917.750000, 1.004886],
[-9917.125000, 1.002960],
[-9916.500000, 1.000554],
[-9915.875000, 0.997747],
[-9915.250000, 0.994596],
[-9914.625000, 0.991172],
[-9914.000000, 0.987521],
[-9913.375000, 0.983705],
[-9912.750000, 0.979756],
[-9912.125000, 0.975725],
[-9911.500000, 0.971633],
[-9910.875000, 0.967521],
[-9910.250000, 0.963401],
[-9909.625000, 0.959300],
[-9909.000000, 0.955224],
[-9908.375000, 0.951197],
[-9907.750000, 0.947217],
[-9907.125000, 0.943304],
[-9906.500000, 0.939448],
[-9905.875000, 0.935662],
[-9905.250000, 0.931933],
[-9904.625000, 0.928274],
[-9904.000000, 0.924669],
[-9903.375000, 0.921124],
[-9902.750000, 0.917628],
[-9902.125000, 0.914186],
[-9901.500000, 0.910784],
[-9900.875000, 0.907428],
[-9900.250000, 0.904108],
[-9899.625000, 0.900829],
[-9899.000000, 0.897577],
[-9898.375000, 0.894361],
[-9897.750000, 0.891168],
[-9897.125000, 0.888006],
[-9896.500000, 0.884861],
[-9895.875000, 0.881729],
[-9895.250000, 0.878587],
[-9894.625000, 0.875425],
[-9894.000000, 0.872220],
[-9893.375000, 0.868968],
[-9892.750000, 0.865649],
[-9892.125000, 0.862272],
[-9891.500000, 0.858836],
[-9890.875000, 0.855365],
[-9890.250000, 0.851863],
[-9889.625000, 0.848356],
[-9889.000000, 0.844849],
[-9888.375000, 0.841369],
[-9887.750000, 0.837914],
[-9887.125000, 0.834506],
[-9886.500000, 0.831144],
[-9885.875000, 0.827843],
[-9885.250000, 0.824598],
[-9884.625000, 0.821425],
[-9884.000000, 0.818317],
[-9883.375000, 0.815288],
[-9882.750000, 0.812330],
[-9882.125000, 0.809459],
[-9881.500000, 0.806668],
[-9880.875000, 0.803970],
[-9880.250000, 0.801360],
[-9879.625000, 0.798851],
[-9879.000000, 0.796438],
[-9878.375000, 0.794133],
[-9877.750000, 0.791929],
[-9877.125000, 0.789839],
[-9876.500000, 0.787858],
[-9875.875000, 0.786001],
[-9875.250000, 0.784264],
[-9874.625000, 0.782665],
[-9874.000000, 0.781205]])


k = 0;
for i in range(0, 100_000, 10):
  filename = f"output/spine_interface_{i}.dat"

  hmax.append(0.0)
  t.append(i * dt)

  try:
    with open(filename) as fp:
      for line in fp:
        if len(line) > 20:
          # get h from the node
          numbers = [float(s) for s in line.rstrip().split(' ')]
          hmax[k] = max(hmax[k], abs(numbers[1] - 1.0))
  except FileNotFoundError:
    print(f"file {filename} not found")
    final_i = i
    hmax.pop()
    t.pop()
    break

  k = k + 1

plt.semilogy(t, hmax, label='oophlib')
plt.semilogy(9999+hmax_basilisk[:, 0], hmax_basilisk[:, 1], label='basilisk')
plt.legend()
plt.xlabel('t')
plt.ylabel('interfacial perturbation')
plt.show()

# also plot the travelling waves
